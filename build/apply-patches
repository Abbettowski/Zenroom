#!/bin/sh

# small script to apply patches to submodules

# enable static build of lua_sandbox
if ! grep STATIC lib/lua_sandbox/src/CMakeLists.txt > /dev/null; then
	cd lib/lua_sandbox && patch -p1 < ../../build/lua_sandbox.patch && cd -
fi

if grep 'static const.*lzlib' lib/luazen/src/luazen.c > /dev/null; then
	cd lib/luazen && patch -p1 < ../../build/luazen_build.patch && cd -
fi

cd lib/jemalloc && \
	git checkout -- . && patch < ../../build/jemalloc_static.patch && cd -
